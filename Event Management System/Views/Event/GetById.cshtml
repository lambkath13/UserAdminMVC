@model Event_Management_System.Dto.Event.EventDto


<div class="layout-px-spacing">

    <div class="row layout-spacing">

        <!-- Content -->
        <div class="col-xl-4 col-lg-6 col-md-5 col-sm-12 layout-top-spacing">

            <div class="user-profile layout-spacing">
                <div class="widget-content widget-content-area">
                    <div class="d-flex justify-content-between">
                        <h3 class="">Event</h3>
                        @if (Model.UserId != null && Model.OrganizerId == Model.UserId)
                        {
                            <a asp-action="Update" asp-controller="Event" asp-route-id="@Model.Id" class="mt-2 edit-profile">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round" class="feather feather-edit-3">
                                    <path d="M12 20h9"></path>
                                    <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                                </svg>
                            </a>
                        }
                    </div>

                    <div class="text-center user-info mb-4">
                        <img width="350" height="300" src="/image/@Model.File" alt="event-image"
                             class="rounded shadow-sm mb-3">
                        <h4 style="color: #34d399;">@Model.Title</h4>
                    </div>

                    <div class="user-info-list">
                        <div class="p-4 rounded-4">
                            <ul class="list-unstyled mb-0">
                                <li class="mb-3 d-flex justify-content-between">
                                    <span class="text-muted">Event Status</span>
                                    <span class="text-warning fw-medium">@Model.Status</span>
                                </li>
                                <li class="mb-3 d-flex justify-content-between">
                                    <span class="text-muted">Event Location</span>
                                    <span class="text-warning fw-medium">@Model.Location</span>
                                </li>
                                <li class="mb-3">
                                    <span class="text-muted d-block mb-1">Description</span>
                                    <div class="bg-dark rounded p-3 text-warning" style="white-space: pre-line;">
                                        @Model.Description
                                    </div>
                                </li>
                                <li class="d-flex justify-content-between">
                                    <span class="text-muted">Event Date</span>
                                    <span class="text-warning fw-medium">@Model.EventDate.ToString("dd MMM yyyy")</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>
            </div>

            @if (Model.Users != null)
            {
                <div class="education layout-spacing ">
                    <div class="widget-content widget-content-area">
                        <h3 class="">Event Registrations</h3>

                        @foreach (var user in Model.Users)
                        {
                            <div class="timeline-alter">
                                <div class="item-timeline">
                                    <div class="t-meta-date">
                                        <p class="">@user.RegisteredAt.ToString("dd MMM yyyy")</p>
                                    </div>
                                    <div class="t-dot">
                                    </div>
                                    <div class="t-text">
                                        <p>@user.FullName</p>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>

                </div>
            }

        </div>

        <div class="col-xl-8 col-lg-6 col-md-7 col-sm-12 layout-top-spacing">

            @if (Model.Feedbacks != null)
            {
                <div class="bio layout-spacing ">
                    <div class="widget-content widget-content-area">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <h3 class="mb-1">Event Feedbacks</h3>
                                <p class="mb-0">We value every voice! Take a look at some of the feedback shared by attendees and see how the
                                    event made an impact.</p>
                            </div>
                            @if (Model.UserId == null)
                            {
                                <a href="/auth/register" type="button" class="btn btn-primary rounded-pill">
                                    + Leave Feedback
                                </a>
                            }
                            else
                            {
                                <button type="button" class="btn btn-primary rounded-pill" data-toggle="modal" data-target="#feedbackModal"> + Leave Feedback</button>
                            }
                        </div>

                        <div class="bio-skill-box">
                            <div class="row">
                                @foreach (var feedback in Model.Feedbacks)
                                {
                                    <div class="col-md-6 mb-4">
                                        <div class="card bg-dark text-light shadow rounded-4 p-4 border-0"
                                             style="background-color: #1e1e2f;">
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <div>
                                                    <h5 class="mb-0 fw-semibold">@feedback.User.FullName</h5>
                                                    <small class="text-muted">@feedback.CreatedAt.ToString("dd MMM yyyy")</small>
                                                </div>
                                                <div class="badge bg-success rounded-pill px-3 py-2">
                                                    â˜… @feedback.Rating
                                                </div>
                                            </div>
                                            <p class="mb-0 text-light">@feedback.Content</p>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>

                    </div>
                </div>
            }
        </div>

    </div>
</div>

<!-- Feedback Modal -->
<div class="modal fade" id="feedbackModal" tabindex="-1" role="dialog" aria-labelledby="feedbackModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <form asp-controller="Event" asp-action="Add" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="feedbackModalLabel">Leave Feedback</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <svg xmlns="http://www.w3.org/2000/svg" class="text-dark" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="hidden" name="EventId" value="@Model.Id" />
                    
                    <div class="form-group">
                        <label for="Content">Your Feedback</label>
                        <textarea name="Content" class="form-control" maxlength="50" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="Rating">Rating</label>
                        <select name="Rating" class="form-control" required>
                            <option value="">Select Rating</option>
                            @for (int i = 1; i <= 5; i++)
                            {
                                <option value="@i">@i</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Submit Feedback</button>
                </div>
            </form>
        </div>
    </div>
</div>
